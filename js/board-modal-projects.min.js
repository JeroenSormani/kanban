!function($){$.fn.modal_projects=function(){return this.each(function(){var r=$(this);r.on("show.bs.modal",function(){$("#accordion-projects").empty();for(var r in project_records){var t=project_records[r];t.task_count=0;for(var a in task_records)try{task_records[a].postmeta.kanban_task_project_id==t.ID&&t.task_count++}catch(e){}var o=$(t_modal_projects_panel.render(t));o.appendTo("#accordion-projects")}}),r.on("click",".btn-delete",function(){var r=$(this),t=r.closest(".panel"),a=t.attr("data-id"),e=JSON.parse(JSON.stringify(project_records[a]));e.action="delete_project",e.kanban_nonce=$("#kanban_nonce").val(),$.ajax({method:"POST",url:ajaxurl,data:e}).done(function(r){delete project_records[a];for(var e in task_records)task_records[e].postmeta.kanban_task_project_id==a&&(task_records[e].postmeta.kanban_task_project_id=0,$("#task-"+task_records[e].ID).trigger("save").trigger("populate_project"));t.remove()}).always(function(r){show_growl_msg(r)})}),r.on("focus",".project_title",function(){var r=$(this);r.data("orig",r.val())}),r.on("keyup",".project_title",function(r){var t=$(this);if(13==r.keyCode)return t.trigger("blur"),!1;if(27==r.keyCode){var a=t.data("orig");return t.val(a).trigger("blur"),!1}}),r.on("blur",".project_title",function(){var r=$(this),t=r.val(),a=r.closest(".panel"),e=a.attr("data-id");project_records[e].post_title=t;var o=JSON.parse(JSON.stringify(project_records[e]));o.action="save_project",o.kanban_nonce=$("#kanban_nonce").val(),$.ajax({method:"POST",url:ajaxurl,data:o}).done(function(r){for(var t in task_records)$("#task-"+task_records[t].ID).trigger("populate_project");var o=project_records[e],n=$(t_modal_projects_panel.render(o));a.replaceWith(n),$(".collapse",n).addClass("in"),$(".project_title",n).focus()}).always(function(r){show_growl_msg(r)})})})}}(jQuery);