var t_col_status=new t($("#t-col-status").html()),t_col_tasks=new t($("#t-col-tasks").html()),t_card=new t($("#t-card").html()),t_card_project=new t($("#t-card-project").html()),t_card_user_assigned_to=new t($("#t-card-user-assigned-to").html()),t_card_work_hours=new t($("#t-card-work-hours").html()),t_card_estimate=new t($("#t-card-estimate").html()),t_card_users_dropdown=new t($("#t-card-users-dropdown").html()),t_card_estimates_dropdown=new t($("#t-card-estimates-dropdown").html()),t_card_projects_dropdown=new t($("#t-card-projects-dropdown").html()),t_modal_projects_panel=new t($("#t-modal-projects-panel").html()),sidebar_w,$last_clicked,timers=[];String.prototype.sprintf=function(){var t=this;for(var s in arguments)t=t.replace("{"+s+"}",arguments[s]);return t};var get_screen_size=function(){return $("#screen-size :visible").attr("data-size")},obj_to_arr=function(t){return $.map(t,function(t,s){return[t]})},format_hours=function(t){var s;if(8>t)s=t+"h";else{s=Math.floor(t/8)+"d";var e=Math.floor(t%8);e>0&&(s+=" "+e+"h")}return s},show_growl_msg=function(t){try{$.bootstrapGrowl(t.data.message,{type:"info"})}catch(s){}},add_task_to_status_col=function(t,s){try{t.status_color=status_colors[t.terms.kanban_task_status[0]]}catch(e){}"undefined"==typeof t.terms.kanban_task_estimate&&(t.terms.kanban_task_estimate=0),"undefined"==typeof t.postmeta.kanban_task_user_id_assigned&&(t.postmeta.kanban_task_user_id_assigned="");var a=$(t_card.render(t));return a.prependTo("#status-{0}-tasks".sprintf(s)).board_task(t),$(".col-tasks").same_height(),a};jQuery(function($){$("#filter-wrapper").board_filter(),$("#search-wrapper").board_search(),$("#btn-group-view-compact").board_view(),$("#modal-projects").modal_projects(),$(document).mousedown(function(t){$last_clicked=$(t.target)});for(var t in status_records){var s=status_records[t];try{s.color=status_colors[s.term_id]}catch(e){}0==t&&(s.left_open=0,s.left_close="-{0}".sprintf(sidebar_w)),t==status_records.length-1&&(s.left_open="-{0}".sprintf(2*sidebar_w),s.left_close="-{0}".sprintf(sidebar_w));var a=$(t_col_status.render(s));a.appendTo("#row-statuses").board_sidebar_header();var a=$(t_col_tasks.render(s));a.appendTo("#row-tasks"),statuses[s.term_id]=s}for(var t in task_records){var r=task_records[t];if("undefined"==typeof r.terms.kanban_task_status[0]||0==r.terms.kanban_task_status[0]||"undefined"==typeof statuses[r.terms.kanban_task_status[0]]){var o=$("#row-statuses .col").eq(1).attr("data-id");r.terms.kanban_task_status[0]=o}add_task_to_status_col(r,r.terms.kanban_task_status[0])}$(".col-tasks").sortable({connectWith:".col-tasks",handle:".task-handle",forcePlaceholderSize:!0,forceHelperSize:!0,placeholder:"task-placeholder",over:function(t,s){s.placeholder.closest(".col-tasks").addClass("hover")},out:function(t,s){s.placeholder.closest(".col-tasks").removeClass("hover")},stop:function(t,s){$(".col-tasks.hover").removeClass("hover")},receive:function(t,s){var e=s.item.attr("data-id"),a=s.item.closest(".col-tasks"),r=a.attr("data-status-id");s.item.trigger("status_change",[r]),$(".col-tasks").same_height()}}).disableSelection(),$("body").on("keydown",function(t){var s=$("input:focus, textarea:focus");return 37===t.keyCode&&0===s.length&&t.shiftKey&&($(".col-status:last").hasClass("is-open")?$(".col-status:last").trigger("close"):$(".col-status:first").hasClass("is-open")||$(".col-status:first").trigger("open")),39===t.keyCode&&0===s.length&&t.shiftKey&&($(".col-status:first").hasClass("is-open")?$(".col-status:first").trigger("close"):$(".col-status:last").hasClass("is-open")||$(".col-status:last").trigger("open")),9===t.keyCode&&0===s.length?($("#btn-group-view-compact .btn:has(input:not(:checked))").trigger("click"),!1):83===t.keyCode&&0===s.length?($("#board-search").focus(),!1):void 0});var n=[];if(location.hash){var c=location.hash.substr(1).split("&");for(var t in c){var i=c[t].split("=");"undefined"!=typeof i[1]&&(n[i[0]]=i[1])}}var d=!1;"undefined"!=typeof n.filter_project&&($("#filter-projects-dropdown [data-id="+n.filter_project+"]").click(),d=!0),"undefined"!=typeof n.filter_user&&($("#filter-users-dropdown [data-id="+n.filter_user+"]").click(),d=!0),d&&$("#btn-filter-apply").trigger("click"),$(".col-tasks").on("mouseenter",function(){var t=$(this).attr("data-status-id");$("#status-{0}".sprintf(t)).addClass("hover")}).on("mouseleave",function(){var t=$(this).attr("data-status-id");$("#status-{0}".sprintf(t)).removeClass("hover")}),$(window).load(function(){$(".col-tasks").same_height()}),$(window).resize(function(){$(".col-tasks").same_height()})});