!function($){$.fn.board_filter=function(e){return this.each(function(){var e=$(this),r=new t($("#t-filter-project").html()),o=new t($("#t-filter-user").html()),a=$("#filter-projects-dropdown",e),i=$("#filter-users-dropdown",e);$("#filter-projects",e).on("show.bs.dropdown",function(){$(".project",a).remove();for(var t in board.project_records){var e=$(r.render(board.project_records[t]));e.prependTo(a)}}),a.on("click","a",function(){var t=$(this),r=t.attr("data-id"),o=board.project_records[r];"undefined"==typeof o&&(o={title:t.text()});var a=t.closest(".dropup"),i=$(".btn-label",a);return"undefined"==typeof i.attr("data-orig")&&i.attr("data-orig",i.text()),i.text(o.title),"undefined"!=typeof r&&""!=r&&(board.filters.project.selector="[data-project-id="+r+"]",board.filters.project.hash="filter_project="+r+"&",$("#btn-filter-apply",e).trigger("click")),!1}),$("#filter-users",e).on("show.bs.dropdown",function(){$(".user",i).remove();for(var t in board.allowed_users()){var e=board.allowed_users()[t];if(user_has_cap("write",e)){var r=$(o.render(e));r.prependTo(i)}}}),i.on("click","a",function(){var t=$(this),r=t.attr("data-id"),o=board.allowed_users()[r];"undefined"==typeof o&&(o={long_name_email:t.text()});var a=t.closest(".dropup"),i=$(".btn-label",a);return"undefined"==typeof i.attr("data-orig")&&i.attr("data-orig",i.text()),i.text(o.long_name_email),"undefined"!=typeof r&&""!=r&&(board.filters.user.selector="[data-assigned-to="+r+"]",board.filters.user.hash="filter_user="+r+"&",$("#btn-filter-apply",e).trigger("click")),!1}),$("#btn-filter-apply",e).on("click",function(){$("#btn-filter-reset").show();var t="",e="#";for(var r in board.filters)"undefined"!=typeof board.filters[r].selector&&(t+=board.filters[r].selector),"undefined"!=typeof board.filters[r].hash&&(e+=board.filters[r].hash);var o=$(".task"+t);location.hash=e,$(".task").not(o).slideUp("fast"),o.slideDown("fast")}),$("#btn-filter-reset",e).on("click",function(){$(this).hide(),$(".task:not(:visible)").slideDown("fast"),$("#filter-wrapper .btn-label").each(function(){var t=$(this);t.text(t.attr("data-orig"))});for(var t in board.filters)board.filters[t]={};location.hash="#"})})}}(jQuery);